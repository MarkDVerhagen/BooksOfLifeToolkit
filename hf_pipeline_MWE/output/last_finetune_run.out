wandb: Tracking run with wandb version 0.17.4
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
/scratch/gpfs/vs3041/prefer_prepare/hf_pipeline_MWE/scripts/fine_tuning_with_hf.py:26: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data["labels"] = (data["labels"] == "kid: 1").astype(int)
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:02<00:07,  2.53s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:05<00:05,  2.61s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:15<00:06,  6.04s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.76s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.90s/it]
Some weights of LlamaForSequenceClassification were not initialized from the model checkpoint at /scratch/gpfs/vs3041/prefer_prepare/hf_pipeline_MWE/hf_models/Meta-Llama-3-8B/ and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
PEFT Model
trainable params: 13,639,680 || all params: 7,518,572,544 || trainable%: 0.1814
Map:   0%|          | 0/600 [00:00<?, ? examples/s]Map: 100%|██████████| 600/600 [00:00<00:00, 1982.46 examples/s]Map: 100%|██████████| 600/600 [00:00<00:00, 1913.70 examples/s]
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
wandb: WARNING The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
wandb: WARNING URL not available in offline run
  0%|          | 0/300 [00:00<?, ?it/s]We detected that you are passing `past_key_values` as a tuple and this is deprecated and will be removed in v4.43. Please use an appropriate `Cache` class (https://huggingface.co/docs/transformers/v4.41.3/en/internal/generation_utils#transformers.Cache)
  0%|          | 1/300 [00:04<22:21,  4.49s/it]  1%|          | 2/300 [00:08<20:20,  4.10s/it]  1%|          | 3/300 [00:12<19:40,  3.98s/it]  1%|▏         | 4/300 [00:15<19:19,  3.92s/it]  2%|▏         | 5/300 [00:19<19:06,  3.89s/it]  2%|▏         | 6/300 [00:23<18:57,  3.87s/it]  2%|▏         | 7/300 [00:27<18:50,  3.86s/it]  3%|▎         | 8/300 [00:31<18:44,  3.85s/it]  3%|▎         | 9/300 [00:35<18:39,  3.85s/it]  3%|▎         | 10/300 [00:38<18:35,  3.85s/it]  4%|▎         | 11/300 [00:42<18:31,  3.85s/it]  4%|▍         | 12/300 [00:46<18:28,  3.85s/it]  4%|▍         | 13/300 [00:50<18:24,  3.85s/it]  5%|▍         | 14/300 [00:54<18:20,  3.85s/it]  5%|▌         | 15/300 [00:58<18:17,  3.85s/it]  5%|▌         | 16/300 [01:02<18:13,  3.85s/it]  6%|▌         | 17/300 [01:05<18:10,  3.85s/it]  6%|▌         | 18/300 [01:09<18:07,  3.85s/it]  6%|▋         | 19/300 [01:13<18:03,  3.85s/it]  7%|▋         | 20/300 [01:17<18:00,  3.86s/it]                                                  7%|▋         | 20/300 [01:17<18:00,  3.86s/it]  7%|▋         | 21/300 [01:21<17:56,  3.86s/it]  7%|▋         | 22/300 [01:25<17:52,  3.86s/it]  8%|▊         | 23/300 [01:29<17:49,  3.86s/it]  8%|▊         | 24/300 [01:32<17:45,  3.86s/it]  8%|▊         | 25/300 [01:36<17:41,  3.86s/it]  9%|▊         | 26/300 [01:40<17:38,  3.86s/it]  9%|▉         | 27/300 [01:44<17:34,  3.86s/it]  9%|▉         | 28/300 [01:48<17:30,  3.86s/it] 10%|▉         | 29/300 [01:52<17:26,  3.86s/it] 10%|█         | 30/300 [01:56<17:23,  3.86s/it] 10%|█         | 31/300 [02:00<17:19,  3.86s/it] 11%|█         | 32/300 [02:03<17:15,  3.86s/it] 11%|█         | 33/300 [02:07<17:11,  3.87s/it] 11%|█▏        | 34/300 [02:11<17:08,  3.87s/it] 12%|█▏        | 35/300 [02:15<17:04,  3.87s/it] 12%|█▏        | 36/300 [02:19<17:00,  3.87s/it] 12%|█▏        | 37/300 [02:23<16:57,  3.87s/it] 13%|█▎        | 38/300 [02:27<16:53,  3.87s/it] 13%|█▎        | 39/300 [02:30<16:49,  3.87s/it] 13%|█▎        | 40/300 [02:34<16:45,  3.87s/it]                                                 13%|█▎        | 40/300 [02:34<16:45,  3.87s/it] 14%|█▎        | 41/300 [02:38<16:42,  3.87s/it] 14%|█▍        | 42/300 [02:42<16:38,  3.87s/it] 14%|█▍        | 43/300 [02:46<16:34,  3.87s/it] 15%|█▍        | 44/300 [02:50<16:30,  3.87s/it] 15%|█▌        | 45/300 [02:54<16:26,  3.87s/it] 15%|█▌        | 46/300 [02:58<16:23,  3.87s/it] 16%|█▌        | 47/300 [03:01<16:19,  3.87s/it] 16%|█▌        | 48/300 [03:05<16:15,  3.87s/it] 16%|█▋        | 49/300 [03:09<16:12,  3.87s/it] 17%|█▋        | 50/300 [03:13<16:08,  3.87s/it] 17%|█▋        | 51/300 [03:17<16:04,  3.87s/it] 17%|█▋        | 52/300 [03:21<16:00,  3.87s/it] 18%|█▊        | 53/300 [03:25<15:56,  3.87s/it] 18%|█▊        | 54/300 [03:29<15:52,  3.87s/it] 18%|█▊        | 55/300 [03:32<15:49,  3.87s/it] 19%|█▊        | 56/300 [03:36<15:45,  3.87s/it] 19%|█▉        | 57/300 [03:40<15:41,  3.87s/it] 19%|█▉        | 58/300 [03:44<15:37,  3.87s/it] 20%|█▉        | 59/300 [03:48<15:33,  3.87s/it] 20%|██        | 60/300 [03:52<15:29,  3.87s/it]                                                 20%|██        | 60/300 [03:52<15:29,  3.87s/it] 20%|██        | 61/300 [03:56<15:26,  3.87s/it] 21%|██        | 62/300 [04:00<15:21,  3.87s/it] 21%|██        | 63/300 [04:03<15:18,  3.87s/it] 21%|██▏       | 64/300 [04:07<15:14,  3.87s/it] 22%|██▏       | 65/300 [04:11<15:10,  3.87s/it] 22%|██▏       | 66/300 [04:15<15:06,  3.87s/it] 22%|██▏       | 67/300 [04:19<15:02,  3.87s/it] 23%|██▎       | 68/300 [04:23<14:58,  3.87s/it] 23%|██▎       | 69/300 [04:27<14:55,  3.88s/it] 23%|██▎       | 70/300 [04:31<14:51,  3.88s/it] 24%|██▎       | 71/300 [04:34<14:47,  3.88s/it] 24%|██▍       | 72/300 [04:38<14:43,  3.88s/it] 24%|██▍       | 73/300 [04:42<14:39,  3.88s/it] 25%|██▍       | 74/300 [04:46<14:35,  3.88s/it] 25%|██▌       | 75/300 [04:50<14:32,  3.88s/it] 25%|██▌       | 76/300 [04:54<14:28,  3.88s/it] 26%|██▌       | 77/300 [04:58<14:24,  3.88s/it] 26%|██▌       | 78/300 [05:02<14:20,  3.88s/it] 26%|██▋       | 79/300 [05:05<14:16,  3.88s/it] 27%|██▋       | 80/300 [05:09<14:12,  3.88s/it]                                                 27%|██▋       | 80/300 [05:09<14:12,  3.88s/it] 27%|██▋       | 81/300 [05:13<14:09,  3.88s/it] 27%|██▋       | 82/300 [05:17<14:05,  3.88s/it] 28%|██▊       | 83/300 [05:21<14:01,  3.88s/it] 28%|██▊       | 84/300 [05:25<13:57,  3.88s/it] 28%|██▊       | 85/300 [05:29<13:53,  3.88s/it] 29%|██▊       | 86/300 [05:33<13:49,  3.88s/it] 29%|██▉       | 87/300 [05:36<13:45,  3.88s/it] 29%|██▉       | 88/300 [05:40<13:41,  3.88s/it] 30%|██▉       | 89/300 [05:44<13:38,  3.88s/it] 30%|███       | 90/300 [05:48<13:34,  3.88s/it] 30%|███       | 91/300 [05:52<13:30,  3.88s/it] 31%|███       | 92/300 [05:56<13:26,  3.88s/it] 31%|███       | 93/300 [06:00<13:22,  3.88s/it] 31%|███▏      | 94/300 [06:04<13:18,  3.88s/it] 32%|███▏      | 95/300 [06:07<13:14,  3.88s/it] 32%|███▏      | 96/300 [06:11<13:10,  3.88s/it] 32%|███▏      | 97/300 [06:15<13:06,  3.88s/it] 33%|███▎      | 98/300 [06:19<13:02,  3.88s/it] 33%|███▎      | 99/300 [06:23<12:59,  3.88s/it] 33%|███▎      | 100/300 [06:27<12:55,  3.88s/it]                                                  33%|███▎      | 100/300 [06:27<12:55,  3.88s/it] 34%|███▎      | 101/300 [06:31<12:51,  3.88s/it] 34%|███▍      | 102/300 [06:35<12:47,  3.88s/it] 34%|███▍      | 103/300 [06:38<12:43,  3.88s/it]